!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).popmotion={})}(this,function(t){"use strict";var r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function n(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var A=function(){return(A=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function s(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]])}return e}function a(t,n,e){var r=n.middleware;return new p({middleware:r,onComplete:e},"function"==typeof t?{update:t}:t)}function e(n,e){return function(t){return Math.max(Math.min(t,e),n)}}function c(t){return t%1?Number(t.toFixed(5)):t}function o(n){return{test:function(t){return"string"==typeof t&&t.endsWith(n)&&1===t.split(" ").length},parse:parseFloat,transform:function(t){return""+t+n}}}function u(t){return void 0!==t.red}function i(t){return void 0!==t.hue}function f(o){return function(t){if("string"!=typeof t)return t;for(var n={},e=function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")"))}(t).split(/,\s*/),r=0;r<4;r++)n[o[r]]=void 0!==e[r]?parseFloat(e[r]):1;return n}}var p=function(t,n){var e=this,r=t.middleware,o=t.onComplete;this.isActive=!0,this.update=function(t){e.observer.update&&e.updateObserver(t)},this.complete=function(){e.observer.complete&&e.isActive&&e.observer.complete(),e.onComplete&&e.onComplete(),e.isActive=!1},this.error=function(t){e.observer.error&&e.isActive&&e.observer.error(t),e.isActive=!1},this.observer=n,this.updateObserver=function(t){return n.update(t)},this.onComplete=o,n.update&&r&&r.length&&r.forEach(function(t){return e.updateObserver=t(e.updateObserver,e.complete)})},d=function(){return(d=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},l=/(-)?(\d[\d\.]*)/g,v=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,h=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))$/i,m={test:function(t){return"number"==typeof t},parse:parseFloat,transform:function(t){return t}},y=d({},m,{transform:e(0,1)}),g=(d({},m,{default:1}),o("deg")),b=o("%"),w=o("px"),x=o("vh"),O=o("vw"),M=(d({},b,{parse:function(t){return b.parse(t)/100},transform:function(t){return b.transform(100*t)}}),e(0,255)),S=d({},m,{transform:function(t){return Math.round(M(t))}});function P(t,n){return t.startsWith(n)&&h.test(t)}function C(t){return"number"==typeof t?0:t}var k,R={test:function(t){return"string"==typeof t?P(t,"rgb"):u(t)},parse:f(["red","green","blue","alpha"]),transform:function(t){var n=t.red,e=t.green,r=t.blue,o=t.alpha,u=void 0===o?1:o;return function(t){var n=t.red,e=t.green,r=t.blue,o=t.alpha;return"rgba("+n+", "+e+", "+r+", "+(void 0===o?1:o)+")"}({red:S.transform(n),green:S.transform(e),blue:S.transform(r),alpha:c(y.transform(u))})}},j={test:function(t){return"string"==typeof t?P(t,"hsl"):i(t)},parse:f(["hue","saturation","lightness","alpha"]),transform:function(t){var n=t.hue,e=t.saturation,r=t.lightness,o=t.alpha,u=void 0===o?1:o;return function(t){var n=t.hue,e=t.saturation,r=t.lightness,o=t.alpha;return"hsla("+n+", "+e+", "+r+", "+(void 0===o?1:o)+")"}({hue:Math.round(n),saturation:b.transform(c(e)),lightness:b.transform(c(r)),alpha:c(y.transform(u))})}},E=d({},R,{test:function(t){return"string"==typeof t&&P(t,"#")},parse:function(t){var n="",e="",r="";return 4<t.length?(n=t.substr(1,2),e=t.substr(3,2),r=t.substr(5,2)):(n=t.substr(1,1),e=t.substr(2,1),r=t.substr(3,1),n+=n,e+=e,r+=r),{red:parseInt(n,16),green:parseInt(e,16),blue:parseInt(r,16),alpha:1}}}),F=function(t){return"string"==typeof t&&h.test(t)||u(t)||i(t)},D=function(t){return R.test(t)?R.parse(t):j.test(t)?j.parse(t):E.test(t)?E.parse(t):t},T=function(t){return u(t)?R.transform(t):i(t)?j.transform(t):t},V="${c}",U="${n}",q={test:function(t){if("string"!=typeof t||!isNaN(t))return!1;var n=0,e=t.match(l),r=t.match(v);return e&&(n+=e.length),r&&(n+=r.length),0<n},parse:function(t){var n=t,e=[],r=n.match(v);r&&(n=n.replace(v,V),e.push.apply(e,r.map(D)));var o=n.match(l);return o&&e.push.apply(e,o.map(m.parse)),e},createTransformer:function(t){var r=t,o=0,n=t.match(v),u=n?n.length:0;if(n)for(var e=0;e<u;e++)r=r.replace(n[e],V),o++;var i=r.match(l),a=i?i.length:0;if(i)for(e=0;e<a;e++)r=r.replace(i[e],U),o++;return function(t){for(var n=r,e=0;e<o;e++)n=n.replace(e<u?V:U,e<u?T(t[e]):c(t[e]));return n}},getAnimatableNone:function(t){var n=q.parse(t);return q.createTransformer(t)(n.map(C))}};k=function(t,n){if(!t)throw new Error(n)};var X;X=function(t,n){if(!t)throw new Error("Hey, listen! ".toUpperCase()+n)};var Y,_,N=0,B="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(t){return window.requestAnimationFrame(t)}:function(t){var n=Date.now(),e=Math.max(0,16.7-(n-N));N=n+e,setTimeout(function(){return t(N)},e)};(_=Y=Y||{}).Read="read",_.Update="update",_.Render="render",_.PostRender="postRender",_.FixedUpdate="fixedUpdate";function I(t){return dt=t}function L(t){return yt[t].process(vt)}function W(n){return function(t){return 1-n(1-t)}}function H(n){return function(t){return t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2}}function z(t){return t}function G(t){return"number"==typeof t}function $(t,n){return void 0===n&&(n=At),function(t){return 180*t/Math.PI}(Math.atan2(n.y-t.y,n.x-t.x))}function K(n,e){var r=!0;return void 0===e&&(e=n,r=!1),function(t){return r?t-n+e:(n=t,r=!0,e)}}function J(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")}function Q(t){return J(t)&&t.hasOwnProperty("z")}function Z(t,n){return Math.abs(t-n)}function tt(t,n){if(void 0===n&&(n=At),G(t)&&G(n))return Z(t,n);if(J(t)&&J(n)){var e=Z(t.x,n.x),r=Z(t.y,n.y),o=Q(t)&&Q(n)?Z(t.z,n.z):0;return Math.sqrt(Math.pow(e,2)+Math.pow(r,2)+Math.pow(o,2))}return 0}function nt(t,n,e){var r=n-t;return 0==r?1:(e-t)/r}function et(t,n,e){return-e*t+e*n+t}function rt(t,n,e){var r=t*t,o=n*n;return Math.sqrt(Math.max(0,e*(o-r)+r))}function ot(n){return Ct.find(function(t){return t.test(n)})}function ut(t){return"'"+t+"' is not an animatable color. Use the equivalent color code instead."}function it(t,n){var e=ot(t),r=ot(n);k(!!e,ut(t)),k(!!r,ut(n)),k(e.transform===r.transform,"Both colors must be hex/RGBA, OR both must be HSLA.");var o=e.parse(t),u=r.parse(n),i=Pt({},o),a=e===j?et:rt;return function(t){for(var n in i)"alpha"!==n&&(i[n]=a(o[n],u[n],t));return i.alpha=et(o.alpha,u.alpha,t),e.transform(i)}}function at(n,e){return function(t){return e(n(t))}}function st(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(at)}var ct,ft=1/60*1e3,pt=!0,dt=!1,lt=!1,vt={delta:0,timestamp:0},ht=[Y.Read,Y.Update,Y.Render,Y.PostRender],mt=ht.reduce(function(t,n){var r=function(r){var u=[],i=[],a=0,s=!1,o=0,c=new WeakSet,f=new WeakSet,p={cancel:function(t){var n=i.indexOf(t);c.add(t),-1!==n&&i.splice(n,1)},process:function(t){var n,e;if(s=!0,u=(n=[i,u])[0],(i=n[1]).length=0,a=u.length)for(o=0;o<a;o++)(e=u[o])(t),!0!==f.has(e)||c.has(e)||(p.schedule(e),r(!0));s=!1},schedule:function(t,n,e){void 0===n&&(n=!1),void 0===e&&(e=!1),X("function"==typeof t,"Argument must be a function");var r=e&&s,o=r?u:i;c.delete(t),n&&f.add(t),-1===o.indexOf(t)&&(o.push(t),r&&(a=u.length))}};return p}(I);return t.sync[n]=function(t,n,e){return void 0===n&&(n=!1),void 0===e&&(e=!1),dt||bt(),r.schedule(t,n,e),t},t.cancelSync[n]=function(t){return r.cancel(t)},t.steps[n]=r,t},{steps:{},sync:{},cancelSync:{}}),yt=mt.steps,gt=(mt.sync,mt.cancelSync,function(t){dt=!1,vt.delta=pt?ft:Math.max(Math.min(t-vt.timestamp,40),1),pt||(ft=vt.delta),vt.timestamp=t,lt=!0,ht.forEach(L),lt=!1,dt&&(pt=!1,B(gt))}),bt=function(){pt=dt=!0,lt||B(gt)},wt=W,xt=function(n){return function(t){return Math.pow(t,n)}}(2),Ot=W(xt),Mt=H(xt),At={x:0,y:0,z:0},St=(ct=function(t,n,e){return Math.min(Math.max(e,t),n)},function(n,e,t){return void 0!==t?ct(n,e,t):function(t){return ct(n,e,t)}}),Pt=function(){return(Pt=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Ct=[E,R,j];function kt(t,e){var r=t.slice(),o=r.length,u=t.map(function(t,n){return function(n,e){return G(n)?function(t){return et(n,e,t)}:F(n)?it(n,e):Ft(n,e)}(t,e[n])});return function(t){for(var n=0;n<o;n++)r[n]=u[n](t);return r}}function Rt(t){for(var n=q.parse(t),e=n.length,r=0,o=0,u=0,i=0;i<e;i++)r||"number"==typeof n[i]?r++:void 0!==n[i].hue?u++:o++;return{parsed:n,numNumbers:r,numRGB:o,numHSL:u}}function jt(t,n){return G(t)?t/(1e3/n):0}function Et(t,n){return n?t*(1e3/n):0}var Ft=function(t,n){var e=q.createTransformer(n),r=Rt(t),o=Rt(n);return k(r.numHSL===o.numHSL&&r.numRGB===o.numRGB&&r.numNumbers>=o.numNumbers,"Complex values '"+t+"' and '"+n+"' too different to mix. Ensure all colors are of the same type."),st(kt(r.parsed,o.parsed),e)},Dt=(St(0,1),Tt.prototype.create=function(t){return new Tt(t)},Tt.prototype.start=function(t){void 0===t&&(t={});var n=!1,e={stop:function(){}},r=this.props,o=r.init,u=s(r,["init"]),i=o(a(t,u,function(){n=!0,e.stop()}));return e=i?A({},e,i):e,n&&e.stop(),e},Tt.prototype.applyMiddleware=function(t){return this.create(A({},this.props,{middleware:this.props.middleware?[t].concat(this.props.middleware):[t]}))},Tt.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=1===t.length?t[0]:st.apply(void 0,t);return this.applyMiddleware(function(n){return function(t){return n(e(t))}})},Tt);function Tt(t){void 0===t&&(t={}),this.props=t}function Vt(t){return new Dt({init:t})}var Ut=(qt.prototype.applyMiddleware=function(t){return this.create(A({},this.props,{middleware:this.props.middleware?[t].concat(this.props.middleware):[t]}))},qt.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=1===t.length?t[0]:st.apply(void 0,t);return this.applyMiddleware(function(n){return function(t){return n(e(t))}})},qt.prototype.while=function(r){return this.applyMiddleware(function(n,e){return function(t){return r(t)?n(t):e()}})},qt.prototype.filter=function(e){return this.applyMiddleware(function(n){return function(t){return e(t)&&n(t)}})},qt);function qt(t){void 0===t&&(t={}),this.props=t}var Xt,Yt=(n(_t,Xt=Ut),_t.prototype.complete=function(){this.subscribers.forEach(function(t){return t.complete()})},_t.prototype.error=function(n){this.subscribers.forEach(function(t){return t.error(n)})},_t.prototype.update=function(t){for(var n=0;n<this.subscribers.length;n++)this.subscribers[n].update(t)},_t.prototype.subscribe=function(t){var n=this,e=a(t,this.props);return this.subscribers.push(e),{unsubscribe:function(){var t=n.subscribers.indexOf(e);-1!==t&&n.subscribers.splice(t,1)}}},_t.prototype.stop=function(){this.parent&&this.parent.stop()},_t);function _t(){var t=null!==Xt&&Xt.apply(this,arguments)||this;return t.subscribers=[],t}var Nt,Bt=(n(It,Nt=Yt),It.prototype.create=function(t){return new It(t)},It);function It(){return null!==Nt&&Nt.apply(this,arguments)||this}var Lt;Lt=function(t,n){if(!t)throw new Error(n)};var Wt,Ht,zt=0,Gt="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(t){return window.requestAnimationFrame(t)}:function(t){var n=Date.now(),e=Math.max(0,16.7-(n-zt));zt=n+e,setTimeout(function(){return t(zt)},e)};(Ht=Wt=Wt||{}).Read="read",Ht.Update="update",Ht.Render="render",Ht.PostRender="postRender",Ht.FixedUpdate="fixedUpdate";function $t(t){return nn=t}function Kt(t){return an[t].process(rn)}function Jt(){return rn}var Qt,Zt=1/60*1e3,tn=!0,nn=!1,en=!1,rn={delta:0,timestamp:0},on=[Wt.Read,Wt.Update,Wt.Render,Wt.PostRender],un=on.reduce(function(t,n){var r=function(r){var u=[],i=[],a=0,s=!1,o=0,c=new WeakSet,f=new WeakSet,p={cancel:function(t){var n=i.indexOf(t);c.add(t),-1!==n&&i.splice(n,1)},process:function(t){var n,e;if(s=!0,u=(n=[i,u])[0],(i=n[1]).length=0,a=u.length)for(o=0;o<a;o++)(e=u[o])(t),!0!==f.has(e)||c.has(e)||(p.schedule(e),r(!0));s=!1},schedule:function(t,n,e){void 0===n&&(n=!1),void 0===e&&(e=!1),Lt("function"==typeof t,"Argument must be a function");var r=e&&s,o=r?u:i;c.delete(t),n&&f.add(t),-1===o.indexOf(t)&&(o.push(t),r&&(a=u.length))}};return p}($t);return t.sync[n]=function(t,n,e){return void 0===n&&(n=!1),void 0===e&&(e=!1),nn||pn(),r.schedule(t,n,e),t},t.cancelSync[n]=function(t){return r.cancel(t)},t.steps[n]=r,t},{steps:{},sync:{},cancelSync:{}}),an=un.steps,sn=un.sync,cn=un.cancelSync,fn=function(t){nn=!1,rn.delta=tn?Zt:Math.max(Math.min(t-rn.timestamp,40),1),tn||(Zt=rn.delta),rn.timestamp=t,en=!0,on.forEach(Kt),en=!1,nn&&(tn=!1,Gt(fn))},pn=function(){tn=nn=!0,en||Gt(fn)},dn=(n(ln,Qt=Yt),ln.prototype.create=function(t){return new ln(t)},ln.prototype.get=function(){return this.current},ln.prototype.getVelocity=function(){return this.getVelocityOfCurrent()},ln.prototype.update=function(t){Qt.prototype.update.call(this,t),this.prev=this.current,this.updateCurrent(t);var n=Jt(),e=n.delta,r=n.timestamp;this.timeDelta=e,this.lastUpdated=r,sn.postRender(this.scheduleVelocityCheck)},ln.prototype.subscribe=function(t){var n=Qt.prototype.subscribe.call(this,t);return this.subscribers[this.subscribers.length-1].update(this.current),n},ln.prototype.getSingleVelocity=function(t,n){return"number"==typeof t&&"number"==typeof n?Et(t-n,this.timeDelta):Et(parseFloat(t)-parseFloat(n),this.timeDelta)||0},ln);function ln(t){var n=Qt.call(this,t)||this;return n.scheduleVelocityCheck=function(){return sn.postRender(n.velocityCheck)},n.velocityCheck=function(t){t.timestamp!==n.lastUpdated&&(n.prev=n.current)},n.prev=n.current=t.value||0,n.updateCurrent=function(t){return n.current=t},n.getVelocityOfCurrent=function(){return n.getSingleVelocity(n.current,n.prev)},t.initialSubscription&&n.subscribe(t.initialSubscription),n}function vn(n){return Pn.find(function(t){return t.test(n)})}function hn(t,n){return t(n)}function mn(t,n){var e=n.from,r=n.to,o=s(n,["from","to"]),u=vn(e)||vn(r),i=u.transform,a=u.parse;return t(A({},o,{from:"string"==typeof e?a(e):e,to:"string"==typeof r?a(r):r})).pipe(i)}function yn(u){return function(t,n){var e=n.from,r=n.to,o=s(n,["from","to"]);return t(A({},o,{from:0,to:1})).pipe(u(e,r))}}function gn(r,t){var n=function(e){function r(t,n){return void 0!==t&&!e[n](t)}var t=Object.keys(e);return{getVectorKeys:function(e){return t.reduce(function(t,n){return r(e[n],n)&&t.push(n),t},[])},testVectorProps:function(n){return n&&t.some(function(t){return r(n[t],t)})}}}(t),o=n.testVectorProps,u=n.getVectorKeys;return function(t){if(!o(t))return r(t);var n=u(t),e=t[n[0]];return Rn(e)(r,t,n)}}function bn(V){return void 0===V&&(V={}),Vt(function(t){function e(t){var n;void 0===t&&(t=!1),F=Dn({from:x=(n=[M,x])[0],to:M=n[1],ease:p,reverseEase:t}).start(i)}function r(){D=Tn(nt(0,c,S)),F.seek(D)}function n(){T=!0,u=sn.update(function(t){var n=t.delta;S+=n,r(),function(){var t=T&&c+b<S;return!!t&&(!(!t||h||l||y)||(S=S-c-b,h&&E<h?(E++,!1):l&&C<l?(C++,e(),!1):!(y&&R<y)||(e(++R%2!=0),!1)))}()&&(cn.update(u),a&&sn.update(a,!1,!0))},!0)}function o(){T=!1,u&&cn.update(u)}var u,i=t.update,a=t.complete,s=V.duration,c=void 0===s?300:s,f=V.ease,p=void 0===f?Ot:f,d=V.flip,l=void 0===d?0:d,v=V.loop,h=void 0===v?0:v,m=V.yoyo,y=void 0===m?0:m,g=V.repeatDelay,b=void 0===g?0:g,w=V.from,x=void 0===w?0:w,O=V.to,M=void 0===O?1:O,A=V.elapsed,S=void 0===A?0:A,P=V.flipCount,C=void 0===P?0:P,k=V.yoyoCount,R=void 0===k?0:k,j=V.loopCount,E=void 0===j?0:j,F=Dn({from:x,to:M,ease:p}).start(i),D=0,T=!1;return n(),{isActive:function(){return T},getElapsed:function(){return St(0,c,S)},getProgress:function(){return D},stop:function(){o()},pause:function(){return o(),this},resume:function(){return T||n(),this},seek:function(t){return S=et(0,c,t),sn.update(r,!1,!0),this},reverse:function(){return e(),this}}})}function wn(t){var n=t.easings,e=t.ease,r=void 0===e?z:e,o=t.times,u=t.values,i=s(t,["easings","ease","times","values"]);n=Array.isArray(n)?n:function(t,n){return t.map(function(){return n||Ot}).splice(0,t.length-1)}(u,n),o=o||function(t){var e=t.length;return t.map(function(t,n){return 0!==n?n/(e-1):0})}(u);var a=n.map(function(t,n){return Dn({from:u[n],to:u[n+1],ease:t})});return bn(A({},i,{ease:r})).applyMiddleware(function(t){return function(r,t,n){var o=r.length,u=o-1,i=u-1,a=t.map(function(t){return t.start(n)});return function(t){t<=r[0]&&a[0].seek(0),t>=r[u]&&a[i].seek(1);for(var n=1;n<o&&!(r[n]>t||n===u);n++);var e=nt(r[n-1],r[n],t);a[n-1].seek(Vn(e))}}(o,a,t)})}function xn(t){var f=t.getCount,p=t.getFirst,d=t.getOutput,l=t.mapApi,v=t.setProp,h=t.startActions;return function(c){return Vt(function(t){function r(){return n(a)}var n=t.update,o=t.complete,u=t.error,i=f(c),a=d(),s=0,e=h(c,function(t,n){var e=!1;return t.start({complete:function(){e||(e=!0,++s===i&&sn.update(o))},error:u,update:function(t){v(a,n,t),sn.update(r,!1,!0)}})});return Object.keys(p(e)).reduce(function(t,n){return t[n]=l(e,n),t},{})})}}function On(t,n){return Array.isArray(n)?t.push.apply(t,function(t){var r=[],n=t[t.length-1],e="number"==typeof n,o=e?n:0,u=e?t.slice(0,-1):t,i=u.length,a=0;return u.forEach(function(t,n){if(r.push(t),n!==i-1){var e=t.duration||300;a+=o,r.push("-"+(e-a))}}),r}(n)):t.push(n),t}function Mn(t,n,e){var r=t.duration,o=t.easings,u=t.times,i=t.values,a=i.length,s=u[a-1],c=0===n.at?0:n.at/r,f=(n.at+n.duration)/r;if(0===e)i.push(n.from),u.push(c);else if(s!==c){void 0!==n.from&&(i.push(i[a-1]),u.push(c),o.push(z));var p=void 0!==n.from?n.from:i[a-1];i.push(p),u.push(c),o.push(z)}else void 0!==n.from&&(i.push(n.from),u.push(c),o.push(z));return i.push(n.to),u.push(f),o.push(n.ease||Mt),t}function An(r,o,u){return Vt(function(t){var n=t.update,e=o.split(" ").map(function(t){return r.addEventListener(t,n,u),t});return{stop:function(){return e.forEach(function(t){return r.removeEventListener(t,n,u)})}}})}function Sn(t,n){return void 0===n&&(n={clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}),n.clientX=n.x=t.clientX,n.clientY=n.y=t.clientY,n.pageX=t.pageX,n.pageY=t.pageY,n}var Pn=[w,b,g,x,O],Cn=yn(it),kn=yn(Ft),Rn=function(t){return"number"==typeof t?hn:function(t){return Boolean(vn(t))}(t)?mn:F(t)?Cn:q.test(t)?kn:hn},jn=gn(function(b){return void 0===b&&(b={}),Vt(function(t){var o=t.complete,u=t.update,n=b.velocity,e=void 0===n?0:n,r=b.from,i=void 0===r?0:r,a=b.power,s=void 0===a?.8:a,c=b.timeConstant,f=void 0===c?350:c,p=b.restDelta,d=void 0===p?.5:p,l=b.modifyTarget,v=0,h=s*e,m=Math.round(i+h),y=void 0===l?m:l(m),g=sn.update(function(t){var n=t.delta;v+=n;var e=-h*Math.exp(-v/f),r=d<e||e<-d;u(r?y+e:y),r||(cn.update(g),o())},!0);return{stop:function(){return cn.update(g)}}})},{from:m.test,modifyTarget:function(t){return"function"==typeof t},velocity:m.test}),En=gn(function(S){return void 0===S&&(S={}),Vt(function(t){var s=t.update,c=t.complete,n=S.velocity,f=void 0===n?0:n,e=S.from,r=void 0===e?0:e,o=S.to,p=void 0===o?0:o,u=S.stiffness,d=void 0===u?100:u,i=S.damping,l=void 0===i?10:i,a=S.mass,v=void 0===a?1:a,h=S.restSpeed,m=void 0===h?.01:h,y=S.restDelta,g=void 0===y?.01:y,b=f?-f/1e3:0,w=0,x=p-r,O=r,M=O,A=sn.update(function(t){var n=t.delta;w+=n;var e=l/(2*Math.sqrt(d*v)),r=Math.sqrt(d/v)/1e3;if(M=O,e<1){var o=Math.exp(-e*r*w),u=r*Math.sqrt(1-e*e);O=p-o*((b+e*r*x)/u*Math.sin(u*w)+x*Math.cos(u*w))}else{o=Math.exp(-r*w);O=p-o*(x+(b+r*x)*w)}f=Et(O-M,n);var i=Math.abs(f)<=m,a=Math.abs(p-O)<=g;i&&a?(s(O=p),cn.update(A),c()):s(O)},!0);return{stop:function(){return cn.update(A)}}})},{from:m.test,to:m.test,stiffness:m.test,damping:m.test,mass:m.test,velocity:m.test}),Fn=gn(function(t){var n=t.from,v=void 0===n?0:n,e=t.velocity,h=void 0===e?0:e,m=t.min,y=t.max,r=t.power,g=void 0===r?.8:r,o=t.timeConstant,b=void 0===o?700:o,u=t.bounceStiffness,w=void 0===u?500:u,i=t.bounceDamping,x=void 0===i?10:i,a=t.restDelta,O=void 0===a?1:a,M=t.modifyTarget;return Vt(function(t){function e(t){return void 0!==m&&t<=m}function r(t){return void 0!==y&&y<=t}function n(t){return e(t)||r(t)}function o(t){a(t),c=f,h=Et((f=t)-c,Jt().delta),i&&!p&&function(t,n){return e(t)&&n<0||r(t)&&0<n}(t,h)&&d({from:t,velocity:h})}function u(t,n){i&&i.stop(),i=t.start({update:o,complete:function(){n?n():s()}})}var i,a=t.update,s=t.complete,c=v,f=v,p=!1,d=function(t){p=!0,u(En(A({},t,{to:e(t.from)?m:y,stiffness:w,damping:x,restDelta:O})))};if(n(v))d({from:v,velocity:h});else if(0!==h){var l=jn({from:v,velocity:h,timeConstant:b,power:g,restDelta:n(v)?20:O,modifyTarget:M});u(l,function(){n(f)?d({from:f,velocity:h}):s()})}else s();return{stop:function(){return i&&i.stop()}}})},{from:m.test,velocity:m.test,min:m.test,max:m.test,damping:m.test,stiffness:m.test,modifyTarget:function(t){return"function"==typeof t}}),Dn=gn(function(t){var n=t.from,e=void 0===n?0:n,r=t.to,o=void 0===r?1:r,u=t.ease,i=void 0===u?z:u,a=t.reverseEase;return void 0!==a&&a&&(i=wt(i)),Vt(function(t){var n=t.update;return{seek:function(t){return n(t)}}}).pipe(i,function(t){return et(e,o,t)})},{ease:function(t){return"function"==typeof t},from:m.test,to:m.test}),Tn=St(0,1),Vn=St(0,1),Un=gn(function(m){return void 0===m&&(m={}),Vt(function(t){var r=t.complete,o=t.update,n=m.acceleration,u=void 0===n?0:n,e=m.friction,i=void 0===e?0:e,a=m.velocity,s=void 0===a?0:a,c=m.springStrength,f=m.to,p=m.restSpeed,d=void 0===p?.001:p,l=m.from,v=void 0===l?0:l,h=sn.update(function(t){var n=t.delta,e=Math.max(n,16);u&&(s+=jt(u,e)),i&&(s*=Math.pow(1-i,e/100)),void 0!==c&&void 0!==f&&(s+=(f-v)*jt(c,e));v+=jt(s,e),o(v),!1!==d&&(!s||Math.abs(s)<=d)&&(cn.update(h),r())},!0);return{set:function(t){return v=t,this},setAcceleration:function(t){return u=t,this},setFriction:function(t){return i=t,this},setSpringStrength:function(t){return c=t,this},setSpringTarget:function(t){return f=t,this},setVelocity:function(t){return s=t,this},stop:function(){return cn.update(h)}}})},{acceleration:m.test,friction:m.test,velocity:m.test,from:m.test,to:m.test,springStrength:m.test}),qn=xn({getOutput:function(){return{}},getCount:function(t){return Object.keys(t).length},getFirst:function(t){return t[Object.keys(t)[0]]},mapApi:function(o,u){return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return Object.keys(o).reduce(function(t,n){var e;return o[n][u]&&(r[0]&&void 0!==r[0][n]?t[n]=o[n][u](r[0][n]):t[n]=(e=o[n])[u].apply(e,r)),t},{})}},setProp:function(t,n,e){return t[n]=e},startActions:function(e,r){return Object.keys(e).reduce(function(t,n){return t[n]=r(e[n],n),t},{})}}),Xn=[{clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0}],Yn=!1;if("undefined"!=typeof document){An(document,"touchstart touchmove",{passive:!0,capture:!0}).start(function(t){var n=t.touches;Yn=!0;for(var e=n.length,r=Xn.length=0;r<e;r++){var o=n[r];Xn.push(Sn(o))}})}function _n(t){var n=void 0===t?{}:t,e=n.preventDefault,f=void 0===e||e,r=n.scale,p=void 0===r?1:r,o=n.rotate,d=void 0===o?0:o;return Vt(function(t){var o=t.update,u={touches:Xn,scale:p,rotate:d},i=0,a=0,s=1<Xn.length;if(s){var n=Xn[0],e=Xn[1];i=tt(n,e),a=$(n,e)}function r(){if(s){var t=Xn[0],n=Xn[1],e=tt(t,n),r=$(t,n);u.scale=p*(e/i),u.rotate=d+(r-a)}o(u)}var c=An(document,"touchmove",{passive:!f}).start(function(t){(f||1<t.touches.length)&&t.preventDefault(),sn.update(r)});return Yn&&sn.update(r),{stop:function(){cn.update(r),c.stop()}}})}var Nn={clientX:0,clientY:0,pageX:0,pageY:0,x:0,y:0},Bn=!1;if("undefined"!=typeof document){An(document,"mousedown mousemove",!0).start(function(t){Bn=!0,Sn(t,Nn)})}function In(t){var n=(void 0===t?{}:t).preventDefault,o=void 0===n||n;return Vt(function(t){function n(){return e(Nn)}var e=t.update,r=An(document,"mousemove").start(function(t){o&&t.preventDefault(),sn.update(n)});return Bn&&sn.update(n),{stop:function(){cn.update(n),r.stop()}}})}function Ln(t){return t[0]}function Wn(t){return void 0===t&&(t={}),Yn?_n(t).pipe(function(t){return t.touches},Ln):In(t)}function Hn(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return Vt(function(t){var n,e=t.update,r=t.complete,o=0,u=function(){n=i[o].start({complete:function(){++o>=i.length?r():u()},update:e})};return u(),{stop:function(){return n&&n.stop()}}})}function zn(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $n(t)}function Gn(r){return Vt(function(t){var n=t.complete,e=setTimeout(n,r);return{stop:function(){return clearTimeout(e)}}})}var $n=xn({getOutput:function(){return[]},getCount:function(t){return t.length},getFirst:function(t){return t[0]},mapApi:function(n,r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.map(function(t,n){if(t[r])return Array.isArray(e[0])?t[r](e[0][n]):t[r].apply(t,e)})}},setProp:function(t,n,e){return t[n]=e},startActions:function(t,e){return t.map(function(t,n){return e(t,n)})}});t.Action=Dt,t.ValueReaction=dn,t.action=Vt,t.chain=Hn,t.composite=qn,t.crossfade=function(n,e){return Vt(function(r){var o=0,t=zn(n,e).start(A({},r,{update:function(t){var n=t[0],e=t[1];r.update(et(n,e,o))}}));return{setBalance:function(t){return o=t},stop:function(){return t.stop()}}})},t.decay=jn,t.delay=Gn,t.everyFrame=function(){return Vt(function(t){var e=t.update,r=0,n=sn.update(function(t){var n=t.timestamp;e(n-(r=r||n))},!0,!0);return{stop:function(){return cn.update(n)}}})},t.inertia=Fn,t.keyframes=wn,t.listen=An,t.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vt(function(n){var t=e.map(function(t){return t.start(n)});return{stop:function(){return t.forEach(function(t){return t.stop()})}}})},t.mouse=In,t.multicast=function(){return new Bt},t.multitouch=_n,t.parallel=zn,t.physics=Un,t.pointer=function(t){void 0===t&&(t={});var n=t.x,e=t.y,r=s(t,["x","y"]);if(void 0===n&&void 0===e)return Wn(r);var o=K(n||0),u=K(e||0),i={x:0,y:0};return Wn(r).pipe(function(t){return i.x=o(t.x),i.y=u(t.y),i})},t.schedule=function(i,a){return Vt(function(t){var n,e=t.update,r=t.complete,o=i.start({update:function(){return void 0!==n&&e(n)},complete:r}),u=a.start({update:function(t){return n=t},complete:r});return{stop:function(){o.stop(),u.stop()}}})},t.spring=En,t.stagger=function(t,r){var o="number"==typeof r,n=t.map(function(t,n){var e=o?r*n:r(n);return Hn(Gn(e),t)});return zn.apply(void 0,n)},t.styler=function(){return Lt(!1,"styler has been removed from Popmotion in 9.0. Downgrade to 8.x or npm install stylefire")},t.timeline=function(t,n){var e=void 0===n?{}:n,r=e.duration,o=e.elapsed,u=e.ease,i=e.loop,a=e.flip,s=e.yoyo,c=0,f=0,p=t.reduce(On,[]),d=[];p.forEach(function(t){if("string"==typeof t)c+=parseFloat(t);else if("number"==typeof t)c=t;else{var n=A({},t,{at:c});n.duration=void 0===n.duration?300:n.duration,d.push(n),c+=n.duration,f=Math.max(f,n.at+n.duration)}});for(var l={},v=d.length,h=0;h<v;h++){var m=d[h],y=m.track;if(void 0===y)throw new Error("No track defined");l.hasOwnProperty(y)||(l[y]=[]),l[y].push(m)}var g={};for(var b in l)if(l.hasOwnProperty(b)){var w=l[b].reduce(Mn,{duration:f,easings:[],times:[],values:[]});g[b]=wn(A({},w,{duration:r||f,ease:u,elapsed:o,loop:i,yoyo:s,flip:a}))}return qn(g)},t.tween=bn,t.value=function(t,n){return new dn({value:t,initialSubscription:n})},Object.defineProperty(t,"__esModule",{value:!0})});
